<!CCSDOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html >
<head><style needdelete>td {border-style:dotted;border-width:1px;border-color:#aaaaaa;} table {border-style:dashed;border-width:1px;border-color:#aaaaaa;}</style>
<meta ccsServiceable="true" name="GENERATOR" content="CodeCharge Studio 4.1.00.031"/><meta ccsServiceable="true" http-equiv="content-type" content="text/html; charset=windows-1252"/>

<title>T_BUDGET</title>


<!--#include File="../include/sessi.inc"-->
<script type="text/javascript" src="../js/jquery.js"></script>
<script language="JavaScript" src="../js/calendarWidget.js" type="text/javascript"></script>
<script language="JavaScript" src="../js/qs.js"></script>
<script language="JavaScript" type="text/javascript">
function getFrom_LOV(formName,fieldList,LOV_NM)
{
    //view_LOV(formName,fieldList,LOV_NM)
        arrLOV = LOV_NM.split("?");
        window.open("../bil_lov/"+arrLOV[0]+"?FORM="+formName+"&OBJ="+fieldList+"&"+arrLOV[1],"LOV","width=600,height=500,toolbar=no,scrollbars=yes,resizable=yes");
}

function lovFinance()
{
        classname = "BATCH1";
        fieldname = "P_FINANCE_PERIOD_ID,FINANCE_PERIOD_CODE";
        filename = "lov_p_finance_period.php";
                
        getFrom_LOV(classname,fieldname,filename)
}

function lovCycle()
{
                classname = "BATCH1";
        fieldname = "P_BILL_CYCLE_ID,BILL_CYCLE_CODE";
        filename = "lov_p_bill_cycle.php";
                
        getFrom_LOV(classname,fieldname,filename)
}

</script>
<script language="JavaScript" type="text/javascript">
//Begin CCS script
//Include Common JSFunctions @1-9722A627
</script>
<script language="JavaScript" src="../ClientI18N.php?file=Functions.js&amp;locale={res:CCS_LocaleID}" type="text/javascript" charset="utf-8"></script>
<script language="JavaScript" type="text/javascript">
//End Include Common JSFunctions

//_OnLoad @1-9C4F01C0
function _OnLoad()
{
    var result = true;
//End _OnLoad

//Custom Code @57-2A29BDB7
    // -------------------------
    // Write your own code here.
    // -------------------------
//End Custom Code

//Close _OnLoad @1-BC33A33A
    return result;
}
//End Close _OnLoad

//bind_events @1-B4BAE7CE
function bind_events() {
    addEventHandler("", "load", _OnLoad);
}
//End bind_events

window.onload = bind_events; //Assign bind_events @1-19F7B649

//End CCS script

function toL13(){
        var idIDC = document.getElementById("v_input_data_control_bill_invoiceGridIDCid").value;
        location.href = "V_R_L13.php?INPUT_DATA_CONTROL_ID="+idIDC;
}

function toR_STAMP_DUTY(){
        var idIDC = document.getElementById("v_input_data_control_bill_invoiceGridIDCid").value;
        location.href = "R_STAMP_DUTY.php?INPUT_DATA_CONTROL_ID="+idIDC;
}

function toV_SUM_AR3210(){
        var idIDC = document.getElementById("v_input_data_control_bill_invoiceGridIDCid").value;
        location.href = "V_SUM_AR3210.php?INPUT_DATA_CONTROL_ID="+idIDC;
}

function toJobProLog(){
        alert("Job Control is required!!");
}

</script>

<link ccsServiceable="true" rel="stylesheet" type="text/css" href="../Styles/trb/Style_doctype.css" ccsdynamicstyle="href"/>

</head>
<body style="MARGIN: 0px" marginheight="0" marginwidth="0">

<table cellspacing="0" cellpadding="0" width="100%" border="0">
  <tr>
    <td><img ccsServiceable="true" border="0" src="../images/tab_s_on.gif"/></td> 
    <td class="th" background="../images/tab_on.gif" nowrap align="center">BILLING PERIOD</td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_e_on.gif"/></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_s_off.gif"/></td> 
    <td class="th" background="../images/tab_off.gif" nowrap align="center"><span ccsServiceable="true" ccsHtmlTag="label" ccsHtmlTag_onclick="javascript:toL13()">L13 INVOICE</span></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_e_off.gif" width="16" height="24"/></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_s_off.gif"/></td> 
    <td class="th" background="../images/tab_off.gif" nowrap align="center"><span ccsServiceable="true" ccsHtmlTag="label" ccsHtmlTag_onclick="javascript:toR_STAMP_DUTY()">STAMP DUTY</span></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_e_off.gif" width="16" height="24"/></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_s_off.gif"/></td> 
    <td class="th" background="../images/tab_off.gif" nowrap align="center"><span ccsServiceable="true" ccsHtmlTag="label" ccsHtmlTag_onclick="javascript:toV_SUM_AR3210()">AR 3210 SUMMARY</span></td> 
    <td><img ccsServiceable="true" border="0" src="../images/tab_e_off.gif" width="16" height="24"/></td> 
    <td background="../images/tab_back.gif" width="100%"></td>
  </tr>
</table>
<br>
<table align="center">
  <tr>
    <td>
      <span contentEditable="true"  style="display:block;border-style:dashed;border-color:#FF3333; border-width:thin" ccsType="Component" ccsId="3" ccsServiceable="true" ccsName="v_input_data_control_bill_invoiceSearch" >
      
<form ccsServiceable="true" id="v_input_data_control_bill_invoiceSearch" method="post" name="{HTMLFormName}" action="{Action}">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td valign="top">
              <table class="Record" cellspacing="0" cellpadding="0">
                <!-- BEGIN Error -->
                <tr class="Error">
                  <td>{Error}</td>
                </tr>
                <!-- END Error -->
                <tr class="Controls">
                  <td class="th"><span ccsServiceable="true" ccsHtmlTag="label" ccsHtmlTag_for="v_input_data_control_bill_invoiceSearchs_keyword">&nbsp;</span><input ccsServiceable="true" ccsId="5" ccsName="s_keyword" ccsType="Component" id="v_input_data_control_bill_invoiceSearchs_keyword" class="ControlsIN" style="TEXT-TRANSFORM: uppercase" maxlength="32" size="32" value="{s_keyword}" name="{s_keyword_Name}"/>
                    <input ccsServiceable="true" ccsId="4" ccsName="Button_DoSearch" ccsType="Component" ccsExtendedHtml="true" id="v_input_data_control_bill_invoiceSearchButton_DoSearch" class="Button" alt="Search" type="submit" value="Search" name="{Button_Name}"/></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </form>

      &nbsp;</span><br>
      <span contentEditable="true"  style="display:block;border-style:dashed;border-color:#FF3333; border-width:thin" ccsType="Component" ccsId="282" ccsServiceable="true" ccsName="v_input_data_control_bill_invoiceGrid" >
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td valign="top">
            <table class="Header" cellspacing="0" cellpadding="0" border="0">
              <tr>
                <td class="HeaderLeft"><img ccsServiceable="true" border="0" alt="" src="../Styles/trb/Images/Spacer.gif" ccsdynamicstyle="src"/></td> 
                <td class="th"><strong>BILLING&nbsp;PERIOD LIST </strong></td> 
                <td class="HeaderRight"><img ccsServiceable="true" border="0" alt="" src="../Styles/trb/Images/Spacer.gif" ccsdynamicstyle="src"/></td>
              </tr>
            </table>
 
            <table id="table1" class="Grid" cellspacing="0" cellpadding="0">
              <tr class="Caption">
                <th style="TEXT-ALIGN: center" scope="col">#</th>
 
                <th scope="col">BATCH&nbsp;ID</th>
 
                <th scope="col">BATCH TYPE</th>
 
                <th scope="col">FINANCE PERIOD CODE</th>
 
                <th scope="col">INVOICE DATE</th>
 
                <th scope="col">BILL CYCLE CODE</th>
 
                <th scope="col">BILL STATUS</th>
 
                <th scope="col">TOTAL BILL AMOUNT</th>
 
                <th scope="col">CLOSING DATE</th>
 
                <th scope="col">CLOSED BY</th>
 
                <th scope="col">CREATION DATE</th>
 
                <th scope="col">CREATED BY</th>
              </tr>
 
              <tr  ccsType="Block" isBegin="True" name="Row" ccsServiceable="true" ><td atomicselection="true" unselectable="on" colspan="99" style="border-right: black 1px solid;border-top: 2px groove;border-left: 2px groove;border-bottom: black 1px solid;background-color:#DDDDDD" ccsServiceable="true"><span style="width:100%;height:100%;border-style:none;font-size:xx-small;font-family:Arial" unselectable="on" ccsServiceable="true"> Begin Row</span></td></tr>
              <tr  class="Row" {v_input_data_control_bill_invoiceGrid:rowStyle}>
                <td style="TEXT-ALIGN: center">
                  <span ccsType="Component" ccsId="52" ccsName="DLink" ccsExtendedHtml="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsServiceable="true" contentEditable="true"><a ccsServiceable="true"  href="{DLink_Src}" id="v_input_data_control_bill_invoiceGridDLink_{BATCH:rowNumber}"><span style="white-space:nowrap" ccsBlockIsWhiteSpace="true" ccsServiceable="true"><img ccsServiceable="true" border="0" src="../images/radio.gif"/></span></a></span>
                  <span ccsType="Component" ccsId="54" ccsName="ADLink" ccsExtendedHtml="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsServiceable="true" contentEditable="true"><a ccsServiceable="true"  href="{ADLink_Src}" id="v_input_data_control_bill_invoiceGridADLink_{BATCH:rowNumber}"><span style="white-space:nowrap" ccsBlockIsWhiteSpace="true" ccsServiceable="true"><img ccsServiceable="true" border="0" src="../images/radio_s.gif" width="16" height="16"/></span></a></span></td> 
                <td style="TEXT-ALIGN: right"><span ccsId="284" ccsName="INPUT_DATA_CONTROL_ID" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">INPUT_DATA_CONTROL_ID</span>&nbsp;</td> 
                <td><span ccsId="310" ccsName="BATCH_TYPE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">BATCH_TYPE</span>&nbsp;</td> 
                <td><span ccsId="311" ccsName="FINANCE_PERIOD_CODE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">FINANCE_PERIOD_CODE</span>&nbsp;</td> 
                <td><span ccsId="296" ccsName="INVOICE_DATE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">INVOICE_DATE</span>&nbsp;</td> 
                <td><span ccsId="314" ccsName="BILL_CYCLE_CODE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">BILL_CYCLE_CODE</span>&nbsp;</td> 
                <td><span ccsId="315" ccsName="BILL_STATUS" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">BILL_STATUS</span>&nbsp;</td> 
                <td style="TEXT-ALIGN: right"><span ccsId="297" ccsName="BILL_AMT" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">BILL_AMT</span>&nbsp;</td> 
                <td><span ccsId="300" ccsName="CLOSING_DATE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">CLOSING_DATE</span>&nbsp;</td> 
                <td><span ccsId="301" ccsName="CLOSED_BY" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">CLOSED_BY</span>&nbsp;</td> 
                <td><span ccsId="291" ccsName="CREATION_DATE" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">CREATION_DATE</span>&nbsp;</td> 
                <td><span ccsId="292" ccsName="OPERATOR_ID" ccsBlockIsWhiteSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px" ccsType="Component" ccsServiceable="true" contentEditable="false">OPERATOR_ID</span>&nbsp;</td>
              </tr>
 <tr  ccsType="Block" isBegin="False" name="Row" ccsServiceable="true" ><td atomicselection="true" unselectable="on" colspan="99" style="border-right: black 1px solid;border-top: 2px groove;border-left: 2px groove;border-bottom: black 1px solid;background-color:#DDDDDD" ccsServiceable="true"><span style="width:100%;height:100%;border-style:none;font-size:xx-small;font-family:Arial" unselectable="on" ccsServiceable="true"> End Row</span></td></tr>
              <!-- BEGIN NoRecords -->
              <tr class="NoRecords">
                <td colspan="12">Data not found</td>
              </tr>
              <!-- END NoRecords -->
              <tr class="Footer">
                <td style="BORDER-RIGHT: 0px">&nbsp;<input ccsServiceable="true" ccsId="392" ccsName="IDCid" ccsType="Component" id="v_input_data_control_bill_invoiceGridIDCid" style="HEIGHT: 22px; WIDTH: 55px" size="1" value="{IDCid}" name="{IDCid_Name}"/></td> 
                <td colspan="12">&nbsp; 
                  <span ccsId="316" ccsName="Navigator" ccsType="Navigator" ccsControlType="Navigator" ccsControlName="Navigator" ccsExtendedHtml="true" atomicselection="true"  ccsServiceable="true" ccsExtendedHtmlSpan="true">
                  <span ccsId="" ccsName="First_On" name="First_On" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px"><a ccsServiceable="true" href="{First_URL}"><img ccsServiceable="true" border="0" alt="{First_URL}" src="../Styles/trb/Images/First.gif" ccsdynamicstyle="src"/></a> </span>
                  <span ccsId="" ccsName="Prev_On" name="Prev_On" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px"><a ccsServiceable="true" href="{Prev_URL}"><img ccsServiceable="true" border="0" alt="{Prev_URL}" src="../Styles/trb/Images/Prev.gif" ccsdynamicstyle="src"/></a> </span>&nbsp; 
                  <span ccsId="" ccsName="Pages" name="Pages" ccsType="Block" ccsServiceable="true" contentEditable="true">
                  <span ccsId="" ccsName="Page_On" name="Page_On" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px"><a ccsServiceable="true" href="{Page_URL}">{Page_Number}</a>&nbsp;</span>
                  <span ccsId="" ccsName="Page_Off" name="Page_Off" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px">{Page_Number}&nbsp;</span></span>&nbsp;{Total_Pages}&nbsp; 
                  <span ccsId="" ccsName="Next_On" name="Next_On" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px"><a ccsServiceable="true" href="{Next_URL}"><img ccsServiceable="true" border="0" alt="{Next_URL}" src="../Styles/trb/Images/Next.gif" ccsdynamicstyle="src"/></a> </span>
                  <span ccsId="" ccsName="Last_On" name="Last_On" ccsType="Block" ccsServiceable="true" contentEditable="true" ccsPreserveEndSpace="true" style="white-space:nowrap;border-color:#bbbbbb;border-style:solid;border-width:1px"><a ccsServiceable="true" href="{Last_URL}"><img ccsServiceable="true" border="0" alt="{Last_URL}" src="../Styles/trb/Images/Last.gif" ccsdynamicstyle="src"/></a> </span>&nbsp;</span>&nbsp;</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
      &nbsp;</span><br>
      
<input ccsServiceable="true" ccsId="393" ccsName="Button1" ccsType="Component" ccsExtendedHtml="true" name="{Button_Name}" type="submit" value="Button1" alt="Button1" id="Button1" onclick="fnExcelReport();"/></td>
  </tr>
</table>
<!--#include File="../include/function.inc"-->
<script language="JavaScript">
// === FUNGSI ANGKA ===
function checkIt(evt) {
var charCode = (evt.which) ? evt.which : event.keyCode
if (charCode > 31 && (charCode < 40 || charCode > 57)) {
return false
}
return true
}


function fnExcelReport(){
        var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('table1'); // id of table
        
        window.alert(tab.rows.length);
        for(j = 0 ; j < tab.rows.length ; j++) {     
                tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
        }

          tab_text=tab_text+"</table>";
          tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
          tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
          tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

               var ua = window.navigator.userAgent;
              var msie = ua.indexOf("MSIE "); 

                 if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
                    {
                           txtArea1.document.open("txt/html","replace");
                           txtArea1.document.write(tab_text);
                           txtArea1.document.close();
                           txtArea1.focus(); 
                            sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
                          }  
                  else                 //other browser not tested on IE 11
                      sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  


                      return (sa);
                            }
</script>

</body>
</html>
